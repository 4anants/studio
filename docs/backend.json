{
  "entities": {
    "Employee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Employee",
      "type": "object",
      "description": "Represents an employee within the FileSafe application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the employee entity."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the employee."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the employee."
        },
        "email": {
          "type": "string",
          "description": "The email address of the employee.",
          "format": "email"
        },
        "department": {
          "type": "string",
          "description": "The department the employee belongs to."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "department"
      ]
    },
    "Admin": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Admin",
      "type": "object",
      "description": "Represents an administrator user within the FileSafe application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the admin entity."
        },
        "firstName": {
          "type": "string",
          "description": "The first name of the administrator."
        },
        "lastName": {
          "type": "string",
          "description": "The last name of the administrator."
        },
        "email": {
          "type": "string",
          "description": "The email address of the administrator.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email"
      ]
    },
    "Document": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Document",
      "type": "object",
      "description": "Represents a document stored in the FileSafe application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the document entity."
        },
        "fileName": {
          "type": "string",
          "description": "The name of the file."
        },
        "fileType": {
          "type": "string",
          "description": "The type of the file (e.g., PDF, DOCX)."
        },
        "uploadDate": {
          "type": "string",
          "description": "The date and time the document was uploaded.",
          "format": "date-time"
        },
        "employeeId": {
          "type": "string",
          "description": "Reference to Employee. (Relationship: Employee 1:N Document). Nullable if uploaded by admin."
        },
        "adminId": {
          "type": "string",
          "description": "Reference to Admin. (Relationship: Admin 1:N Document). Nullable if uploaded by employee."
        },
        "documentCategory": {
          "type": "string",
          "description": "Category of the Document (e.g. Salary Slip, Medical Report, Appraisal Letter, Personal Document)"
        },
        "fileSize": {
          "type": "number",
          "description": "Size of the uploaded file in bytes."
        }
      },
      "required": [
        "id",
        "fileName",
        "fileType",
        "uploadDate",
        "documentCategory",
        "fileSize"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/employees/{employeeId}",
        "definition": {
          "entityName": "Employee",
          "schema": {
            "$ref": "#/backend/entities/Employee"
          },
          "description": "Stores employee data.  Used to associate documents with employees.  Includes `employeeId` as document ID.",
          "params": [
            {
              "name": "employeeId",
              "description": "The unique identifier for the employee."
            }
          ]
        }
      },
      {
        "path": "/admins/{adminId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/backend/entities/Admin"
          },
          "description": "Stores admin data. Used to associate documents with admins. Includes `adminId` as document ID.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier for the admin."
            }
          ]
        }
      },
      {
        "path": "/employees/{employeeId}/documents/{documentId}",
        "definition": {
          "entityName": "Document",
          "schema": {
            "$ref": "#/backend/entities/Document"
          },
          "description": "Stores documents uploaded by employees. Includes `employeeId` as document ID. Requires that the `employeeId` field in the Document be equal to the `{employeeId}` path parameter to ensure data integrity.",
          "params": [
            {
              "name": "employeeId",
              "description": "The unique identifier for the employee."
            },
            {
              "name": "documentId",
              "description": "The unique identifier for the document."
            }
          ]
        }
      },
      {
        "path": "/admins/{adminId}/documents/{documentId}",
        "definition": {
          "entityName": "Document",
          "schema": {
            "$ref": "#/backend/entities/Document"
          },
          "description": "Stores documents uploaded by admins. Includes `adminId` as document ID. Requires that the `adminId` field in the Document be equal to the `{adminId}` path parameter to ensure data integrity.",
          "params": [
            {
              "name": "adminId",
              "description": "The unique identifier for the admin."
            },
            {
              "name": "documentId",
              "description": "The unique identifier for the document."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the FileSafe application's requirements for employee and admin document management. It prioritizes authorization independence and clear access control. The structure employs Structural Segregation, separating employee and admin documents into distinct collections. User-owned documents are stored under their respective user IDs to simplify ownership-based rules. \n\nSpecifically, Authorization Independence is achieved by storing admin uploaded documents in the `/admins/{adminId}/documents/{documentId}` and employee uploaded documents in `/employees/{employeeId}/documents/{documentId}` collections, without referencing each other. All documents uploaded by an employee will be stored at `/employees/{employeeId}/documents/{documentId}`.\n\nThe QAPs for listing documents securely are supported by the segregated structure and path-based ownership, enabling rules to easily filter based on `request.auth.uid`."
  }
}